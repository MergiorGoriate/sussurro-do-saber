import{c as D,r,A as ee,a as se,j as e,e as O,M as V,I as te,l as ae,L as B,o as re,p as le,d as ne,X as oe,f as ie,n as S}from"./main-8XSaGCev.js";import{u as ce,A as de,C as xe}from"./AuthModal-CDVm9kls.js";import{A as ue}from"./award-CUm1wkoe.js";import{M as me}from"./map-pin-CZ08nAR7.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],ge=D("bell",be),he=(c,a)=>{const[b,d]=r.useState(a),o=r.useRef(null);return r.useEffect(()=>{d(a)},[a.views,a.followers,a.karma]),r.useEffect(()=>{if(!c)return;const u=`${ee}/analytics/stream/author/${encodeURIComponent(c)}/`;o.current&&o.current.close();const i=new EventSource(u);return o.current=i,i.onopen=()=>{},i.addEventListener("update",g=>{try{const l=JSON.parse(g.data);d(h=>{const x={...h};return l.type==="view"?x.views=(x.views||0)+(l.data.delta||0):l.type==="follower"?x.followers=l.data.total:l.type==="karma"&&(x.karma=l.data.total),x})}catch(l){console.error("Error parsing SSE author update:",l)}}),i.onerror=g=>{},()=>{o.current&&(o.current.close(),o.current=null)}},[c]),b},v=({value:c,label:a})=>{const[b,d]=r.useState(0),o=r.useRef(null),u=r.useRef(0),i=r.useRef(0);r.useEffect(()=>{u.current=b,o.current=null;const x=Math.abs(c-u.current)<10?600:2500,f=j=>{o.current||(o.current=j);const p=Math.min((j-o.current)/x,1),k=1-Math.pow(1-p,4),N=u.current+(c-u.current)*k;d(N),p<1?i.current=requestAnimationFrame(f):d(c)};return i.current=requestAnimationFrame(f),()=>cancelAnimationFrame(i.current)},[c]);const g=l=>l>=1e3?(l/1e3).toFixed(1)+"k":Math.floor(l).toLocaleString();return e.jsxs("div",{className:"flex flex-col items-center group cursor-default p-4 rounded-2xl hover:bg-gray-50 dark:hover:bg-slate-900 transition-colors w-full sm:w-32",title:`${Math.floor(b)} ${a}`,children:[e.jsx("span",{className:"block text-2xl md:text-3xl font-black text-brand-blue dark:text-white transition-colors mb-1",children:g(b)}),e.jsx("span",{className:"text-[10px] text-slate-400 dark:text-slate-500 font-black uppercase tracking-widest",children:a})]})},we=()=>{var z,C,E,_,R,P,F,I,$,L,T,q;const{name:c}=se(),a=decodeURIComponent(c||""),[b,d]=r.useState(!1),[o,u]=r.useState(""),[i,g]=r.useState(""),[l,h]=r.useState(""),[x,f]=r.useState(!1),[j,p]=r.useState(!1),[k,N]=r.useState([]),[U,A]=r.useState(!0),[s,J]=r.useState(null),{isFollowing:M,handleFollow:X,isAuthModalOpen:Y,closeAuthModal:G,onAuthSuccess:H}=ce(a),K=()=>localStorage.getItem("accessToken");r.useEffect(()=>{(async()=>{A(!0);const[w,Z]=await Promise.all([S.getArticlesByAuthor(a),S.getAuthorProfile(a)]);N(w),J(Z),A(!1)})()},[a]);const m={name:s!=null&&s.first_name?`${s.first_name} ${s.last_name}`.trim():a,role:((z=s==null?void 0:s.profile)==null?void 0:z.scientific_area)||"Investigador",location:((C=s==null?void 0:s.profile)==null?void 0:C.institution)||"Instituição não informada",joinedDate:s!=null&&s.date_joined?`Membro desde ${new Date(s.date_joined).getFullYear()}`:"Membro da Comunidade",bio:((E=s==null?void 0:s.profile)==null?void 0:E.bio)||`Perfil de investigador de ${a}.`,image:((_=s==null?void 0:s.profile)==null?void 0:_.photo)||null,social:{instagram:(R=s==null?void 0:s.profile)==null?void 0:R.instagram_url,linkedin:(P=s==null?void 0:s.profile)==null?void 0:P.linkedin_url,researchgate:(F=s==null?void 0:s.profile)==null?void 0:F.research_gate_url,orcid:(I=s==null?void 0:s.profile)==null?void 0:I.orcid_url},stats:{articles:k.length,reads:(($=s==null?void 0:s.stats)==null?void 0:$.reads)||0,followers:((L=s==null?void 0:s.stats)==null?void 0:L.followers)||0,karma:((T=s==null?void 0:s.stats)==null?void 0:T.karma)||0},badges:((q=s==null?void 0:s.profile)==null?void 0:q.badges)||[]},y=he(a,{views:m.stats.reads,followers:m.stats.followers,karma:m.stats.karma}),t={...m,stats:{...m.stats,reads:y.views??m.stats.reads,followers:y.followers??m.stats.followers,karma:y.karma??m.stats.karma}},Q=()=>{d(!0),p(!1),h("")},W=async n=>{if(n.preventDefault(),!!l.trim()){f(!0);try{await S.sendMessageToAuthor(a,{name:o||"Leitor Anônimo",email:i||"anonimo@leitor.com",message:l},K()||void 0),p(!0),setTimeout(()=>{d(!1)},2e3)}catch{alert("Erro ao enviar mensagem. Tente novamente.")}finally{f(!1)}}};return a?e.jsxs("div",{className:"min-h-screen bg-brand-light/30 dark:bg-slate-950 transition-colors duration-300 relative",children:[e.jsx("div",{className:"bg-white dark:bg-slate-900 border-b border-slate-100 dark:border-slate-800",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-6 py-12 md:py-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 md:gap-14 items-start",children:[e.jsx("div",{className:"shrink-0",children:e.jsx("div",{className:"w-24 h-24 md:w-32 md:h-32 rounded-full bg-slate-50 dark:bg-slate-800 border border-slate-100 dark:border-slate-700 flex items-center justify-center shadow-sm relative overflow-hidden group",children:t.image?e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):e.jsx("span",{className:"text-4xl font-black text-brand-blue dark:text-blue-400",children:t.name.charAt(0)})})}),e.jsxs("div",{className:"flex-grow pt-2",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"inline-block text-2xl md:text-3xl font-black text-brand-blue dark:text-white tracking-tight border-b-[3px] border-blue-100 dark:border-blue-900/50 pb-1 mb-2",children:t.name}),t.badges.map((n,w)=>e.jsxs("span",{className:`px-2 py-0.5 rounded-full text-[8px] font-black uppercase tracking-widest flex items-center gap-1 ${n.type==="verified"?"bg-blue-50 text-brand-blue border border-blue-100":"bg-amber-50 text-amber-600 border border-amber-100"}`,title:n.label,children:[e.jsx(ue,{size:10})," ",n.label]},w))]}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-[0.2em]",children:t.role})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{console.log("[AuthorPage] Follow button clicked"),X()},className:`px-6 py-2.5 rounded-xl font-black text-[10px] uppercase tracking-widest transform transition-all duration-300 ${M?"bg-slate-100 dark:bg-slate-800 text-brand-blue dark:text-blue-400":"bg-brand-blue text-white hover:bg-brand-dark shadow-lg shadow-blue-500/10"}`,children:M?e.jsxs(e.Fragment,{children:[e.jsx(O,{size:14})," Seguindo"]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:14})," Seguir"]})}),e.jsxs("button",{onClick:Q,className:"px-6 py-2.5 border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-slate-50 dark:hover:bg-slate-800 transition-all flex items-center gap-2",children:[e.jsx(V,{size:14})," Mensagem"]}),e.jsx(de,{isOpen:Y,onClose:G,onSuccess:H,intentText:`Para seguir ${t.name}, crie a sua conta em segundos.`})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-6 text-[10px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-tight mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{size:14})," ",t.location]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{size:14})," ",t.joinedDate]})]}),e.jsxs("p",{className:"text-slate-600 dark:text-slate-300 leading-relaxed max-w-3xl mb-8 font-serif italic text-lg",children:['"',t.bio,'"']}),e.jsxs("div",{className:"flex items-center gap-3",children:[t.social.instagram&&e.jsx("a",{href:t.social.instagram,target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 rounded-xl border border-slate-200 dark:border-slate-800 flex items-center justify-center text-slate-400 hover:text-brand-blue hover:border-brand-blue transition-all","aria-label":"Instagram",children:e.jsx(te,{size:18})}),t.social.linkedin&&e.jsx("a",{href:t.social.linkedin,target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 rounded-xl border border-slate-200 dark:border-slate-800 flex items-center justify-center text-slate-400 hover:text-brand-blue hover:border-brand-blue transition-all","aria-label":"LinkedIn",children:e.jsx(ae,{size:18})})]})]})]}),e.jsxs("div",{className:"mt-16 bg-slate-50 dark:bg-slate-800/30 rounded-[32px] p-2 flex flex-col sm:flex-row justify-around border border-slate-100 dark:border-slate-800",children:[e.jsx(v,{value:t.stats.articles,label:"Artigos"}),e.jsx("div",{className:"hidden sm:block w-px bg-slate-200 dark:bg-slate-700 my-4"}),e.jsx(v,{value:t.stats.reads,label:"Visualizações"}),e.jsx("div",{className:"hidden sm:block w-px bg-slate-200 dark:bg-slate-700 my-4"}),e.jsx(v,{value:t.stats.followers,label:"Seguidores"}),e.jsx("div",{className:"hidden sm:block w-px bg-slate-200 dark:bg-slate-700 my-4"}),e.jsx(v,{value:t.stats.karma,label:"Reconhecimento"})]})]})}),e.jsxs("div",{className:"max-w-5xl mx-auto px-6 py-20",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-12",children:[e.jsx("h2",{className:"text-2xl font-black text-slate-900 dark:text-white uppercase tracking-tight font-sans",children:"Repositório de Publicações"}),e.jsx("div",{className:"h-px flex-grow bg-slate-200 dark:bg-slate-800"})]}),U?e.jsx("div",{className:"py-24 flex justify-center",children:e.jsx(B,{className:"animate-spin text-brand-blue",size:32})}):k.length>0?e.jsx("div",{className:"grid md:grid-cols-2 gap-x-12 gap-y-2",children:k.map(n=>e.jsx(re,{article:n},n.id))}):e.jsxs("div",{className:"text-center py-24 bg-white dark:bg-slate-900 rounded-[40px] border border-slate-100 dark:border-slate-800 shadow-sm",children:[e.jsx(le,{size:48,className:"mx-auto text-slate-100 dark:text-slate-800 mb-6"}),e.jsxs("p",{className:"text-slate-400 font-bold uppercase tracking-widest",children:['Ainda não existem manuscritos indexados para "',a,'".']}),e.jsx(ne,{to:"/",className:"inline-block mt-6 text-brand-blue font-black text-xs uppercase hover:underline",children:"Explorar Portal"})]})]}),b&&e.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-950/80 backdrop-blur-md",onClick:()=>d(!1)}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-[32px] shadow-2xl w-full max-w-lg relative z-10 overflow-hidden animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-black text-slate-900 dark:text-white uppercase tracking-tight flex items-center gap-3",children:[e.jsx(V,{size:20,className:"text-brand-blue"})," Contactar Autor"]}),e.jsx("button",{onClick:()=>d(!1),className:"text-slate-400 hover:text-slate-600 transition-colors",title:"Fechar","aria-label":"Fechar modal",children:e.jsx(oe,{size:24})})]}),e.jsx("div",{className:"p-8",children:j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center animate-in fade-in zoom-in",children:[e.jsx("div",{className:"w-16 h-16 bg-green-50 dark:bg-green-900/20 text-green-500 rounded-full flex items-center justify-center mb-6",children:e.jsx(O,{size:32})}),e.jsx("h4",{className:"text-xl font-black text-slate-900 dark:text-white mb-2 uppercase",children:"Manuscrito Enviado"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"O autor receberá a sua comunicação em breve."})]}):e.jsxs("form",{onSubmit:W,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2 ml-1",children:"Seu Nome"}),e.jsx("input",{type:"text",value:o,onChange:n=>u(n.target.value),placeholder:"Ex: João Silva",className:"w-full p-4 bg-slate-50 dark:bg-slate-800 border-none rounded-2xl focus:ring-2 focus:ring-brand-blue outline-none text-slate-700 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2 ml-1",children:"Seu Email"}),e.jsx("input",{type:"email",value:i,onChange:n=>g(n.target.value),placeholder:"email@exemplo.com",className:"w-full p-4 bg-slate-50 dark:bg-slate-800 border-none rounded-2xl focus:ring-2 focus:ring-brand-blue outline-none text-slate-700 dark:text-white",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-slate-400 uppercase tracking-widest mb-3 ml-1",children:"Assunto ou Mensagem Académica"}),e.jsx("textarea",{value:l,onChange:n=>h(n.target.value),placeholder:`Prezado(a) ${t.name.split(" ")[0]}, gostaria de discutir...`,className:"w-full h-44 p-6 bg-slate-50 dark:bg-slate-800 border-none rounded-2xl focus:ring-2 focus:ring-brand-blue transition-all outline-none text-slate-700 dark:text-white font-serif resize-none",required:!0})]}),e.jsxs("button",{type:"submit",disabled:x,className:"w-full py-4 bg-brand-blue text-white rounded-2xl font-black text-xs uppercase tracking-widest hover:bg-brand-dark transition-all flex items-center justify-center gap-2 shadow-lg shadow-blue-500/10",children:[x?e.jsx(B,{size:16,className:"animate-spin"}):e.jsx(ie,{size:16}),"Submeter Comunicação"]})]})})]})]})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center dark:bg-slate-950 dark:text-white",children:"Autor não encontrado"})};export{we as default};
